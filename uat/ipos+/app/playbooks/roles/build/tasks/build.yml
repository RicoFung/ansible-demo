---
# get start build time
- name: ====== 2 ======== get start build time
  shell: date +%Y%m%d_%H%M%S
  register: build_time

- name: ====== 3 ======== npm build
  shell: "source /etc/profile && source ~/.bash_profile && npm install && npm run build"
  args:
    chdir: "{{GV_GIT_DIR}}"
  register: npm_bulid
- debug: msg="{{npm_bulid.stdout_lines}}"

# 本地打包为zip
- name: ====== 4 ======== package as tar.gz
  shell: |
    cd {{GV_GIT_DIR}}
    tar -zcvf {{GV_MODULE_PACKAGE}} {{GV_MODULE_DIR}}
    
#- name: ====== 4 ======== package as zip
#  archive:
#    path: "{{ item.src }}"
#    dest: "{{ item.dest }}"
#  with_items:
#  - { src: "{{GV_GIT_DIR}}/AppPublish/*", dest: "{{GV_MODULE_PACKAGE_PATH}}" }  